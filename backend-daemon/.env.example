# Backend Daemon Environment Configuration

# ============== ZMQ Endpoints ==============
# Input endpoint where audio producers send PCM chunks (PULL socket)
INPUT_ZMQ_ENDPOINT=tcp://0.0.0.0:5556

# Output endpoint where daemon publishes ASR events (PUB socket)
OUTPUT_ZMQ_ENDPOINT=tcp://100.120.2.227:5557


# ============== ASR Model Settings ==============
# ASR model name (default: paraformer-zh)
ASR_MODEL=paraformer-zh

# Model revision (default: v2.0.4)
ASR_MODEL_REV=v2.0.4

# Input audio sample rate in Hz (default: 8000)
# Common values: 8000, 16000, 44100, 48000
ASR_INPUT_SAMPLE_RATE=8000

# Energy gate threshold to filter out silence (default: 0 = disabled)
# Higher values = more aggressive silence filtering
# Typical range: 0-500
ASR_ENERGY_GATE=0


# ============== AEC (Acoustic Echo Cancellation) Settings ==============
# Enable/disable AEC preprocessing (1=enabled, 0=disabled)
# Default: 1 (enabled)
# AEC removes echo from far-end audio (e.g., citizen voice in headset)
ENABLE_AEC=1

# Enable/disable noise suppression (1=enabled, 0=disabled)
# Default: 1 (enabled)
# Reduces background noise in the audio signal
ENABLE_NS=1

# Enable/disable automatic gain control (1=enabled, 0=disabled)
# Default: 0 (disabled)
# Normalizes audio volume levels
ENABLE_AGC=0

# AEC frame size in milliseconds (default: 10)
# Valid values: 10, 20, 30
# Smaller frames = lower latency but higher CPU usage
AEC_FRAME_SIZE_MS=10

# AEC filter length in milliseconds (default: 200)
# Valid range: 50-500
# Longer filters = better echo cancellation but higher latency
# Recommended: 200-300 for typical office environments
AEC_FILTER_LENGTH_MS=200


# ============== Notes ==============
# 1. AEC requires far-end audio (reference signal) to work effectively
#    - ZMQ messages should include 3 parts: [metadata, near_audio, far_audio]
#    - If only 2 parts provided, AEC falls back to noise suppression only
#
# 2. Install AEC dependencies:
#    - pip install webrtc-audio-processing (recommended)
#    - OR pip install speexdsp-python (alternative)
#
# 3. If no AEC library is installed, preprocessing will be disabled
#    and daemon will log a warning but continue to work
