# Voice Chat Backend with ASR

åŸºäºasræ–‡ä»¶å¤¹æ¶æ„ä¼˜åŒ–çš„è¯­éŸ³èŠå¤©åç«¯æœåŠ¡ï¼Œæ”¯æŒå®æ—¶è¯­éŸ³è¯†åˆ«å’ŒWebSocketé€šä¿¡ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ¯ **å®æ—¶è¯­éŸ³èŠå¤©**: WebSocketæ”¯æŒçš„å®æ—¶èŠå¤©åŠŸèƒ½
- ğŸ¤ **è¯­éŸ³è¯†åˆ«**: é›†æˆFunASRæµå¼è¯­éŸ³è¯†åˆ«
- ğŸ³ **DockeråŒ–éƒ¨ç½²**: å®Œæ•´çš„Dockeræ”¯æŒï¼Œæ¨¡å‹é¢„ä¸‹è½½
- ğŸ”„ **Mockæ¨¡å¼**: å½“ASRä¸å¯ç”¨æ—¶è‡ªåŠ¨é™çº§åˆ°Mockæ¨¡å¼
- ğŸ“‹ **RESTful API**: å®Œæ•´çš„èŠå¤©è®°å½•ç®¡ç†API
- ğŸ” **å¥åº·æ£€æŸ¥**: æœåŠ¡çŠ¶æ€ç›‘æ§ç«¯ç‚¹

## API ç«¯ç‚¹

### REST API

1. **è·å–èŠå¤©åˆ—è¡¨**
   ```
   GET /chat/list?id={user_id}
   ```
   è¿”å›æŒ‡å®šç”¨æˆ·çš„æ‰€æœ‰èŠå¤©å†å²

2. **è·å–èŠå¤©è¯¦æƒ…**
   ```
   GET /chat/{chat_id}
   ```
   è¿”å›æŒ‡å®šèŠå¤©çš„è¯¦ç»†ä¿¡æ¯å’Œæ¶ˆæ¯å†å²

3. **å¥åº·æ£€æŸ¥**
   ```
   GET /health
   ```
   è¿”å›æœåŠ¡å™¨çŠ¶æ€ä¿¡æ¯

### WebSocket

```
WebSocket /chatting?id={chat_id}
```
- å¦‚æœchat_idå¯¹åº”çš„ä¼šè¯æ­£åœ¨è¿›è¡Œä¸­ï¼Œå»ºç«‹WebSocketè¿æ¥
- å¦‚æœä¼šè¯å·²ç»“æŸæˆ–ä¸å­˜åœ¨ï¼Œæ‹’ç»è¿æ¥
- è¿æ¥åæ¨é€å†å²æ¶ˆæ¯å’Œå®æ—¶æ¶ˆæ¯

## å®‰è£…å’Œè¿è¡Œ

### æ–¹æ³•1: ä½¿ç”¨æ‰¹å¤„ç†æ–‡ä»¶ï¼ˆæ¨èï¼‰
```bash
# è¿è¡Œ start.bat æ–‡ä»¶ï¼Œä¼šè‡ªåŠ¨å®‰è£…ä¾èµ–å¹¶å¯åŠ¨æœåŠ¡å™¨
start.bat
```

### æ–¹æ³•2: æ‰‹åŠ¨å®‰è£…
```bash
# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# å¯åŠ¨æœåŠ¡å™¨
python main.py
```

## æœåŠ¡å™¨ä¿¡æ¯

- **ç«¯å£**: 8000
- **ä¸»æœº**: 0.0.0.0 (æ‰€æœ‰æ¥å£)
- **APIæ–‡æ¡£**: http://localhost:8000/docs
- **å¥åº·æ£€æŸ¥**: http://localhost:8000/health

## ç¤ºä¾‹ä½¿ç”¨

### è·å–ç”¨æˆ·èŠå¤©åˆ—è¡¨
```bash
curl "http://localhost:8000/chat/list?id=user_001"
```

### WebSocketè¿æ¥
```javascript
const ws = new WebSocket('ws://localhost:8000/chatting?id=chat_active_001');
```

## æ•°æ®æ¨¡å‹

### ChatMessage
- id: æ¶ˆæ¯ID
- chat_id: èŠå¤©ID
- speaker: å‘è¨€äºº ("user" æˆ– "assistant")
- content: æ¶ˆæ¯å†…å®¹
- timestamp: æ—¶é—´æˆ³

### ChatSession
- id: èŠå¤©ID
- user_id: ç”¨æˆ·ID
- title: èŠå¤©æ ‡é¢˜
- status: çŠ¶æ€ ("active" æˆ– "ended")
- created_at: åˆ›å»ºæ—¶é—´
- ended_at: ç»“æŸæ—¶é—´
- messages: æ¶ˆæ¯åˆ—è¡¨

## æµ‹è¯•æ•°æ®

ç³»ç»Ÿå¯åŠ¨æ—¶ä¼šè‡ªåŠ¨åˆ›å»ºä»¥ä¸‹æµ‹è¯•æ•°æ®ï¼š
- ç”¨æˆ·ID: `user_001`
- å·²ç»“æŸçš„èŠå¤©: `chat_001`, `chat_002`, `chat_003`
- æ´»è·ƒèŠå¤©: `chat_active_001`
